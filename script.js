const characterImages = {
  "스나오오카미 시로코": "?https://FrostSnow4731.github.io/images/shiroko.png"
  };

const data = {
  "총학생회": [
    "나나가미 린",
    "유라키 모모카",
    "이와비츠 아유무",
    "시라누이 카야",
    "오키 아오이 🔒",
    "스모모",
    "하이네"
  ],
  "샬레": [
    "아로나",
    "프라나 🔒"
  ],
  "아비도스": [
    "타카나시 호시노 🔒",
    "이자요이 노노미 🔒",
    "스나오오카미 시로코",
    "쿠로미 세리카",
    "오쿠소라 아야네",
    "스나오오카미 시로코(테러)"
  ],
  "게헨나": {
    "만마전": [
      "하누마 마코토",
      "쿄고쿠 사츠키",
      "나츠메 이로하 🔒",
      "모토미야 치아키",
      "탄가 이부키 🔒"
    ],
    "선도부": [
      "소라사키 히나 🔒",
      "아마우 아코 🔒",
      "시로미 이오리 🔒",
      "히노미야 치나츠 🔒"
    ],
    "흥신소": [
      "리쿠하치마 아루 🔒",
      "오니카타 카요코 🔒",
      "아사기 무츠키",
      "이구사 하루카"
    ],
    "미식연구회": [
      "쿠로다테 하루나",
      "와니부치 아카리",
      "시시도우 이즈미",
      "아카시 준코"
    ],
    "온천개발부": [
      "키누가와 카스미 🔒",
      "시모쿠라 메구 🔒"
    ],
    "반짝반짝부": [
      "요자쿠라 키라라",
      "하타미 에리카"
    ],
    "급양부": [
      "아이키요 후우카 🔒",
      "우시마키 주리"
    ],
    "응급의학부": [
      "히무로 세나"
    ]
  },
  "밀레니엄": {
    "세미나": [
      "츠카츠키 리오 🔒",
      "하야세 유우카 🔒",
      "우시오 노아 🔒",
      "쿠로사키 코유키 🔒"
    ],
    "게임개발부": [
      "하나오카 유즈",
      "사이바 미도리",
      "사이바 모모이",
      "텐도 아리스",
      "KEY"
    ],
    "베리타스": [
      "카가미 치히로 🔒",
      "오토세 코타마",
      "오마가리 하레",
      "코누리 마키"
    ],
    "C&C": [
      "미카모 네루",
      "이치노세 아스나 🔒",
      "카쿠다테 카린 🔒",
      "무로카사 아카네",
      "아스마 토키"
    ],
    "엔지니어부": [
      "시라이시 우타하 🔒",
      "네코즈카 히비키",
      "토요미 코토리"
    ],
    "트레이닝부": [
      "오토하나 스미레",
      "노마사 레이"
    ],
    "초현상특무부": [
      "아케보시 히마리 🔒",
      "이즈미모토 에이미"
    ]
  },
  "트리니티": {
  "티파티": [
    "키리후지 나기사 🔒",
    "미소노 미카 🔒",
    "유리조노 세이아 🔒"
  ],
  "보충수업부": [
    "아지타니 히후미 🔒",
    "시라스 아즈사 🔒",
    "우라와 하나코 🔒",
    "시모에 코하루"
  ],
  "자경단": [
    "모리즈키 스즈미",
    "우자와 레이사"
  ],
  "도서부": [
    "코제키 우이",
    "엔도우 시미코"
  ],
  "방과후 디저트부": [
    "쿄야마 카즈사 🔒",
    "쿠리무라 아이리",
    "이바라기 요시미",
    "유토리 나츠"
  ],
  "구호기사단": [
    "아오모리 미네",
    "스미 세리나",
    "아사가오 하나에"
  ],
  "정의실현부": [
    "켄자키 츠루기",
    "하네카와 하스미",
    "나카마사 이치카",
    "시즈야마 마시로"
  ],
  "시스터후드": [
    "우타즈미 사쿠라코 🔒",
    "와카바 히나타",
    "이오치 마리"
  ]
},
"산해경": {
  "현룡문": [
    "류우게 키사키 🔒",
    "코노에 미나 🔒"
  ],
  "연단방": [
    "야쿠시 사야"
  ],
  "매화원": [
    "스노하라 슌",
    "스노하라 코코나"
  ],
  "현무상회": [
    "아케시로 루미",
    "카야마 레이죠"
  ]
},
"백귀야행": {
  "음양부": [
    "아마치 니야",
    "쿠와카미 카호",
    "와라쿠 치세"
  ],
  "마츠리운영관리부": [
    "카와와 시즈코",
    "아사히나 피나",
    "사토하마 우미카"
  ],
  "수행부": [
    "카스가 츠바키",
    "미즈하 미모리",
    "이사미 카에데"
  ],
  "인법연구부": [
    "치도리 미치루",
    "오노 츠쿠요",
    "쿠다 이즈나"
  ],
  "백화요란": [
    "쿠즈노하 🔒",
    "고료 나구사 🔒",
    "후와 렌게",
    "키류 키쿄 🔒",
    "카데노코지 유카리 🔒"
  ],
  "화조풍월부": [
    "야부키 슈로"
  ]
},
"붉은겨울": {
  "사무국": [
    "렌카와 체리노",
    "사시로 토모에",
    "이케쿠라 마리나"
  ],
  "227호 특별반": [
    "아마미 노도카 🔒",
    "마요이 시구레 🔒"
  ],
  "지식해방전선": [
    "히메키 메루",
    "아키이즈미 모미지"
  ],
  "용역부": [
    "야스모리 미노리"
  ],
  "출판부": [
    "미요시 타카네"
  ]
},
"발키리": [
  "오가타 칸나",
  "코노카 🔒",
  "나카츠카사 키리노",
  "네무가키 후부키"
],
"아리우스": [
  "조마에 사오리 🔒",
  "이마시노 미사키 🔒",
  "츠치나가 히요리",
  "하카리 아츠코 🔒"
],
  "SRT": {
    "Rabbit 소대": [
      "츠키유키 미야코",
      "소라이 사키",
      "카제쿠라 모에",
      "카스미자와 미유"
    ],
    "Fox 소대": [
      "시치도 유키노",
      "니코",
      "쿠루미",
      "오토기"
    ]
  },
  "기타": {
    "하이랜더": [
      "아사기리 스오우",
      "타치바나 히카리",
      "타치바나 노조미"
    ],
    "헬멧단": [
      "코마카제 라브"
    ],
    "칠수인": [
      "코사카 와카모",
      "키요스미 아키라 🔒"
    ],
    "기타": [
      "히죽히죽교수"
    ]
  }
};

document.getElementById('intro').addEventListener('click', () => {
  document.getElementById('intro').classList.add('hidden');
});

let currentPopup = null; // 현재 팝업을 추적

function closePopup() {
  if (currentPopup) {
    currentPopup.classList.remove('show'); // 'show' 클래스를 제거하여 닫기 애니메이션 적용
    currentPopup.classList.add('hide'); // 'hide' 클래스를 추가
    setTimeout(() => {
      if (currentPopup && currentPopup.parentNode) {
        currentPopup.parentNode.removeChild(currentPopup); // 애니메이션 후 팝업 제거
        currentPopup = null; // 현재 팝업 초기화
      }
    }, 300); // 애니메이션 시간 (0.3초) 후 제거
  }
}

document.querySelectorAll('.academy').forEach(academy => {
  academy.addEventListener('click', () => {
    if (currentPopup) {
      closePopup(); // 기존 팝업 닫기
      setTimeout(createPopup, 300); // 팝업 닫기 애니메이션 후 새 팝업 생성
    } else {
      createPopup();
    }

    function createPopup() {
      const academyName = academy.querySelector('p').textContent;

      // 팝업 생성
      const contentDiv = document.createElement('div');
      contentDiv.classList.add('popup', 'hide'); // 처음에는 'hide' 상태로 생성
      document.body.appendChild(contentDiv);
      currentPopup = contentDiv; // 현재 팝업 추적

      // 학원명 헤더와 닫기 버튼 생성
      const header = document.createElement('div');
      header.classList.add('popup-header');
      header.innerHTML = `
        <h2>${academyName}</h2>
        <button class="close-button">
          <img src="https://i.imgur.com/pdYHPD6.png" alt="닫기" />
        </button>
      `;
      const closeButton = header.querySelector('.close-button');
      closeButton.addEventListener('click', closePopup); // 닫기 버튼 이벤트 리스너 추가

      // 팝업창에 헤더 추가
      contentDiv.appendChild(header);

      // 팝업 내용 설정
      if (typeof data[academyName] === 'object' && !Array.isArray(data[academyName])) {
        // 동아리가 있는 학원
        const subGroups = Object.keys(data[academyName]);
        const list = document.createElement('ul');
        list.style.listStyle = 'none'; // 리스트 스타일 제거
        list.style.textAlign = 'center'; // 리스트 중앙 정렬

        subGroups.forEach(group => {
          const listItem = document.createElement('li');
          listItem.textContent = group;
          listItem.style.cursor = 'pointer';
          listItem.addEventListener('click', () => {
            contentDiv.innerHTML = `
              <button class="back-button">돌아가기</button>
              <h2>${group}</h2>
              <ul style='list-style: none; text-align: center;'>
                ${data[academyName][group].map(s => `<li>${s}</li>`).join('')}
              </ul>
            `;
            const backButton = document.querySelector('.back-button');
            backButton.addEventListener('click', () => {
              contentDiv.innerHTML = '';
              contentDiv.appendChild(header); // 헤더를 다시 추가
              contentDiv.appendChild(list); // 동아리 목록을 다시 추가
            });
          });
          list.appendChild(listItem);
        });

        contentDiv.appendChild(list);
      } else if (Array.isArray(data[academyName])) {
        // 동아리가 없는 학원
        const students = data[academyName];
        const studentList = document.createElement('ul');
        studentList.style.listStyle = 'none';
        studentList.style.textAlign = 'center';

        students.forEach(student => {
          const listItem = document.createElement('li');
          listItem.textContent = student;
          studentList.appendChild(listItem);
        });

        contentDiv.appendChild(studentList);
      } else {
        contentDiv.innerHTML += `<p>학생 명부가 없습니다.</p>`;
      }


      // 팝업 표시 애니메이션
      setTimeout(() => {
        contentDiv.classList.remove('hide');
        contentDiv.classList.add('show'); // 'show' 클래스를 추가하여 나타나는 애니메이션 적용
      }, 10); // 약간의 딜레이를 추가하여 애니메이션 트리거
    }
  });
});





// CSS for popup with close button
const style = document.createElement('style');
style.textContent = `
  /* 팝업 스타일 및 애니메이션 */
  .popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)),
                url('https://i.imgur.com/q9BYdnw.jpeg') no-repeat center center;
    background-size: cover;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    max-width: 80%;
    max-height: 80%;
    overflow-y: auto;
    text-align: center;
    display: flex;
  flex-direction: column;
  justify-content: center;
  opacity: 0;
  transform: translate(-50%, -60%);
  transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .popup.show {
    opacity: 1; /* 나타날 때 */
    transform: translate(-50%, -50%); /* 원래 위치로 이동 */
  }

  .popup.hide {
    opacity: 0; /* 사라질 때 */
    transform: translate(-50%, -60%); /* 다시 위로 이동 */
  }

  /* 뒤로가기 버튼 스타일 */
  .back-button {
    display: inline-block;
    margin: 10px auto; /* 버튼을 중앙 정렬 */
    background: #007BFF;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 14px; /* 버튼 글씨 크기 */
  }

  .back-button:hover {
    background: #0056b3;
  }
`;
document.head.appendChild(style);
